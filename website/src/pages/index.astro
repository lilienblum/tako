---
import BaseLayout from "../layouts/BaseLayout.astro";
const installCmd = "curl -fsSL https://tako.sh/install | sh";
---
<BaseLayout>
  <Fragment slot="head"><style is:inline>
  .blob {
    position: absolute;
    border-radius: 50%;
    filter: blur(18px);
    opacity: 0.7;
    animation: drift 11s ease-in-out infinite;
  }

  .blob.one {
    width: 360px;
    height: 360px;
    top: -110px;
    left: -120px;
    background: rgba(232, 135, 131, 0.45);
  }

  .blob.two {
    width: 460px;
    height: 460px;
    top: 34%;
    right: -180px;
    background: rgba(155, 196, 182, 0.4);
    animation-delay: -4s;
  }

  .blob.three {
    width: 320px;
    height: 320px;
    bottom: -130px;
    left: 18%;
    background: rgba(158, 201, 255, 0.45);
    animation-delay: -8s;
  }

  .grid-sparkle {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 2;
    background-image: radial-gradient(circle at 1px 1px, rgba(47, 42, 68, 0.15) 1px, transparent 0);
    background-size: 24px 24px;
    mask-image: radial-gradient(ellipse 85% 70% at 50% 35%, #000 40%, transparent 100%);
  }

  .hero {
    border-radius: var(--panel-radius);
    border: 2px solid var(--line);
    background: rgba(255, 255, 255, 0.8);
    box-shadow: 0 18px 45px rgba(47, 42, 68, 0.1);
    padding: clamp(24px, 5vw, 54px);
    overflow: visible;
    position: relative;
    isolation: isolate;
  }

  .hero-bg {
    position: absolute;
    inset: 0;
    border-radius: inherit;
    overflow: hidden;
    pointer-events: none;
    z-index: 0;
  }

  .hero > *:not(.panel-hanger):not(.hero-bg) {
    position: relative;
    z-index: 2;
  }

  .panel-hanger {
    position: absolute;
    top: 26px;
    right: 10px;
    width: 164px;
    height: 152px;
    z-index: 12;
    --swing-angle: 0.17rad;
    --thread-length: 48px;
    --card-tilt: -0.06rad;
    --hanger-axis: 112px;
  }

  .panel-pin {
    position: absolute;
    top: 10px;
    left: calc(var(--hanger-axis) - 5px);
    width: 10px;
    height: 10px;
    border: 2px solid rgba(47, 42, 68, 0.28);
    border-radius: 50%;
    background: var(--secondary);
    box-shadow: 0 2px 0 rgba(47, 42, 68, 0.15);
  }

  .panel-arm {
    position: absolute;
    top: 16px;
    left: var(--hanger-axis);
    width: 0;
    transform-origin: top center;
    transform: rotate(var(--swing-angle));
    pointer-events: none;
  }

  .panel-thread {
    display: block;
    width: 2px;
    margin-left: -1px;
    height: var(--thread-length);
    background: rgba(47, 42, 68, 0.45);
  }

  .panel-tag {
    position: absolute;
    left: 0;
    top: var(--thread-length);
    transform: translateX(-50%) rotate(var(--card-tilt));
    transform-origin: top center;
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    width: 86px;
    border: 2px solid rgba(47, 42, 68, 0.26);
    border-radius: 12px 12px 16px 16px;
    background: linear-gradient(160deg, rgba(255, 255, 255, 0.97), rgba(255, 255, 255, 0.88));
    box-shadow: 0 8px 14px rgba(47, 42, 68, 0.16);
    padding: 8px 10px 10px;
    font-family: "IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: 12px;
    color: rgba(47, 42, 68, 0.86);
    text-align: center;
    z-index: 1;
    pointer-events: auto;
    cursor: grab;
    touch-action: none;
    user-select: none;
  }

  .panel-tag-label {
    display: block;
    font-size: 10px;
    letter-spacing: 0.1em;
    line-height: 1;
    opacity: 0.72;
    text-transform: uppercase;
  }

  .panel-tag-value {
    display: block;
    margin-top: 2px;
    font-size: 18px;
    font-weight: 700;
    letter-spacing: 0.08em;
    line-height: 1;
    color: var(--primary);
  }

  .hero-bg::after {
    content: "";
    position: absolute;
    width: 186px;
    height: 186px;
    right: 16px;
    bottom: 16px;
    border-radius: 42% 58% 60% 40%;
    background: linear-gradient(120deg, rgba(232, 135, 131, 0.38), rgba(255, 217, 125, 0.42));
    transform: rotate(-13deg);
    z-index: 0;
  }


  .badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 9px 14px;
    border-radius: 999px;
    border: 2px solid rgba(47, 42, 68, 0.22);
    background: rgba(255, 255, 255, 0.82);
    font-size: clamp(18px, 2.8vw, 23px);
    margin-bottom: 14px;
  }

  .badge-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--primary);
    animation: pulseDot 2s ease-in-out infinite;
  }

  .title {
    font-family: var(--font-heading);
    font-size: clamp(38px, 8vw, 72px);
    line-height: 1;
    letter-spacing: 0.01em;
    margin-bottom: 14px;
  }

  .mobile-br {
    display: none;
  }

  .title .swirl {
    color: var(--primary);
    text-shadow: 3px 4px 0 rgba(255, 255, 255, 0.85);
  }

  .subtitle {
    max-width: 680px;
    font-size: clamp(18px, 2.8vw, 26px);
    line-height: 1.2;
    color: var(--muted);
    margin-bottom: 24px;
  }

  .command-card {
    border: 2px solid rgba(47, 42, 68, 0.2);
    border-radius: 20px;
    background: var(--paper);
    overflow: hidden;
    max-width: 700px;
  }

  .command-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    background: rgba(158, 201, 255, 0.22);
    border-bottom: 2px solid rgba(47, 42, 68, 0.14);
    padding: 10px 14px;
  }

  .dots {
    display: inline-flex;
    gap: 6px;
  }

  .dots span {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(47, 42, 68, 0.28);
  }

  .command-title {
    font-family: var(--font-heading);
    font-size: 19px;
    font-weight: 600;
  }

  .command-body {
    font-family: "IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: clamp(14px, 2.1vw, 18px);
    padding: 16px;
    display: flex;
    flex-wrap: nowrap;
    gap: 10px;
    align-items: center;
    overflow-x: auto;
  }

  .prompt {
    color: var(--primary);
  }

  .cmd {
    color: #3c3559;
    min-height: 1.2em;
    white-space: nowrap;
  }

  .cursor {
    width: 8px;
    height: 18px;
    background: var(--ink);
    animation: blink 1s steps(1, end) infinite;
  }

  .command-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 0 16px 16px;
  }

  .btn {
    border: 2px solid rgba(47, 42, 68, 0.26);
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.86);
    color: var(--ink);
    padding: 9px 16px;
    font-family: "Nunito", sans-serif;
    font-size: 16px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
  }

  .btn:hover {
    transform: translateY(-1px);
  }

  .btn.primary {
    background: rgba(232, 135, 131, 0.28);
  }

  #copy {
    position: relative;
    text-align: center;
  }

  #copy .copy-label-sizer {
    visibility: hidden;
    white-space: nowrap;
  }

  #copy [data-copy-label] {
    position: absolute;
    inset: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    pointer-events: none;
  }

  .hero-block {
    margin-top: 26px;
    padding-top: 0;
    border-top: 0;
  }

  .hero-block-head {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 14px;
  }

  .hero-block-label {
    font-family: var(--font-heading);
    font-size: 18px;
    font-weight: 600;
    letter-spacing: 0.01em;
    color: rgba(47, 42, 68, 0.9);
  }

  .hero-block-rule {
    flex: 1;
    height: 2px;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(232, 135, 131, 0.42), rgba(155, 196, 182, 0.26), rgba(47, 42, 68, 0.05));
  }

  .feature-grid {
    margin-top: 0;
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
  }

  .feature-item {
    border: 2px solid rgba(47, 42, 68, 0.16);
    border-radius: 18px;
    background: rgba(255, 255, 255, 0.86);
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    min-height: 138px;
  }

  .feature-item:nth-child(odd) {
    background: rgba(255, 255, 255, 0.88);
  }

  .feature-item:nth-child(even) {
    background: rgba(155, 196, 182, 0.12);
  }

  .feature-kicker {
    display: inline-flex;
    width: fit-content;
    border: 1px solid rgba(47, 42, 68, 0.2);
    border-radius: 999px;
    padding: 3px 8px;
    font-family: "Nunito", sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: rgba(47, 42, 68, 0.72);
    background: rgba(255, 255, 255, 0.7);
  }

  .feature-title {
    font-family: var(--font-heading);
    font-size: 19px;
    font-weight: 600;
    line-height: 1.2;
    color: rgba(47, 42, 68, 0.92);
  }

  .feature-desc {
    font-size: 15px;
    line-height: 1.35;
    color: rgba(47, 42, 68, 0.76);
  }

  .feature-more {
    margin-top: 10px;
    text-align: center;
    font-family: "Nunito", sans-serif;
    font-size: 14px;
    letter-spacing: 0.08em;
    text-transform: lowercase;
    color: rgba(47, 42, 68, 0.58);
  }

  .feature-more-prefix {
    text-decoration: none;
  }

  .feature-more-link {
    text-decoration-line: underline;
    text-decoration-color: rgba(47, 42, 68, 0.52);
    text-decoration-thickness: 0.08em;
    text-underline-offset: 0.22em;
    color: inherit;
  }

  .links-grid {
    margin-top: 0;
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
  }

  .link-card {
    border-radius: 18px;
    border: 2px solid rgba(47, 42, 68, 0.16);
    background: rgba(255, 255, 255, 0.82);
    padding: 14px;
    text-decoration: none;
    color: var(--ink);
  }

  .link-card strong {
    display: block;
    font-family: var(--font-heading);
    font-size: 22px;
    font-weight: 600;
    line-height: 1;
  }

  .link-card span {
    display: block;
    font-size: 16px;
    color: rgba(47, 42, 68, 0.76);
    line-height: 1.25;
    margin-top: 6px;
  }

  .link-card:nth-child(1) { transform: rotate(-1.3deg); }
  .link-card:nth-child(2) { transform: rotate(0.6deg); }
  .link-card:nth-child(3) { transform: rotate(-0.7deg); }
  .link-card:hover { transform: translateY(-2px) rotate(-0.2deg); }

  @keyframes drift {
    0%,
    100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-10px) scale(1.04); }
  }


  @keyframes pulseDot {
    0%,
    100% { transform: scale(1); }
    50% { transform: scale(0.72); }
  }

  @keyframes blink {
    0%,
    50% { opacity: 1; }
    51%,
    100% { opacity: 0; }
  }

  @media (max-width: 900px) {
    .feature-grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .links-grid {
      grid-template-columns: 1fr;
    }

    .hero-bg::after {
      width: 160px;
      height: 160px;
      right: 12px;
      bottom: 12px;
    }

    .panel-hanger {
      right: 8px;
      top: 20px;
      transform: scale(0.9);
      transform-origin: top right;
    }
  }

  @media (max-width: 640px) {
    .mobile-br {
      display: block;
    }

    .command-actions {
      flex-direction: column;
      align-items: flex-start;
    }

    .feature-grid {
      grid-template-columns: 1fr;
    }

    .feature-item {
      min-height: 0;
    }

    .hero-block {
      margin-top: 22px;
      padding-top: 0;
    }

    .hero-block-label {
      font-size: 16px;
    }

    .panel-hanger {
      right: 6px;
      top: 18px;
      transform: scale(0.8);
      transform-origin: top right;
    }
  }
  </style></Fragment>

  <Fragment slot="paint">
    <div class="blob one"></div>
    <div class="blob two"></div>
    <div class="blob three"></div>
  </Fragment>
  <div class="grid-sparkle" aria-hidden="true" slot="after-paint"></div>

  <section class="hero">
    <div class="hero-bg" aria-hidden="true"></div>
    <div class="panel-hanger" id="mit-hanger" aria-label="License: MIT">
      <span class="panel-pin" id="mit-pin" aria-hidden="true"></span>
      <div class="panel-arm">
        <span class="panel-thread"></span>
        <div class="panel-tag" id="mit-tag">
          <span class="panel-tag-label">license</span>
          <span class="panel-tag-value">MIT</span>
        </div>
      </div>
    </div>
    <div class="badge"><span class="badge-dot"></span>self-hosted app workflow</div>
    <h1 class="title">Your servers<br />were <span class="swirl">fine</span><br />all along.</h1>
    <p class="subtitle">
      Tako keeps the power-user workflow while giving your deploy day some personality.
      Routes, logs, secrets, rolling deploys. All on your own servers.
    </p>

    <div class="command-card">
      <div class="command-head">
        <div class="dots"><span></span><span></span><span></span></div>
        <div class="command-title">install</div>
        <div>shell</div>
      </div>
      <div class="command-body">
        <span class="prompt">$</span>
        <span class="cmd" id="typed-cmd"></span>
        <span class="cursor" aria-hidden="true"></span>
      </div>
      <div class="command-actions">
        <button class="btn primary" id="copy" type="button">
          <span class="copy-label-sizer" aria-hidden="true">copy install command</span>
          <span data-copy-label>copy install command</span>
        </button>
        <a class="btn" href="/docs">read the docs</a>
      </div>
    </div>

    <div class="hero-block">
      <div class="hero-block-head">
        <p class="hero-block-label">Features</p>
        <span class="hero-block-rule" aria-hidden="true"></span>
      </div>
      <div class="feature-grid">
        <article class="feature-item">
          <span class="feature-kicker">deploy</span>
          <h3 class="feature-title">Rolling deploys without drama</h3>
          <p class="feature-desc">Bring up new instances first, then shift traffic after health checks pass.</p>
        </article>
        <article class="feature-item">
          <span class="feature-kicker">runtime</span>
          <h3 class="feature-title">Automatic health-based routing</h3>
          <p class="feature-desc">When an instance degrades, requests route to healthy ones in seconds.</p>
        </article>
        <article class="feature-item">
          <span class="feature-kicker">ops</span>
          <h3 class="feature-title">Logs and status in one place</h3>
          <p class="feature-desc">Inspect what is running and what failed with direct CLI commands.</p>
        </article>
        <article class="feature-item">
          <span class="feature-kicker">security</span>
          <h3 class="feature-title">Secrets outside your repo</h3>
          <p class="feature-desc">Keep credentials out of git while still making rotation straightforward.</p>
        </article>
        <article class="feature-item">
          <span class="feature-kicker">rollback</span>
          <h3 class="feature-title">Fast rollback path</h3>
          <p class="feature-desc">Recover quickly when a release misbehaves without a full rebuild cycle.</p>
        </article>
        <article class="feature-item">
          <span class="feature-kicker">ownership</span>
          <h3 class="feature-title">Bring your own servers</h3>
          <p class="feature-desc">Keep control of hosts, domains, and certs with zero platform lock-in.</p>
        </article>
      </div>
      <p class="feature-more"><span class="feature-more-prefix">and </span><a class="feature-more-link" href="/docs/spec#feature-overview">more</a></p>
    </div>

    <div class="hero-block">
      <div class="hero-block-head">
        <p class="hero-block-label">Explore</p>
        <span class="hero-block-rule" aria-hidden="true"></span>
      </div>
      <div class="links-grid">
        <a href="/docs/development" class="link-card">
          <strong>Quickstart</strong>
          <span>Get from zero to first app run fast</span>
        </a>
        <a href="/docs/architecture" class="link-card">
          <strong>How It Works</strong>
          <span>See the control-plane and data-plane flow</span>
        </a>
        <a href="/docs/install" class="link-card">
          <strong>Install on a Server</strong>
          <span>Set up hosts and install `tako-server`</span>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style is:global>
  .blob {
    position: absolute;
    border-radius: 50%;
    filter: blur(18px);
    opacity: 0.7;
    animation: drift 11s ease-in-out infinite;
  }

  .blob.one {
    width: 360px;
    height: 360px;
    top: -110px;
    left: -120px;
    background: rgba(232, 135, 131, 0.45);
  }

  .blob.two {
    width: 460px;
    height: 460px;
    top: 34%;
    right: -180px;
    background: rgba(155, 196, 182, 0.4);
    animation-delay: -4s;
  }

  .blob.three {
    width: 320px;
    height: 320px;
    bottom: -130px;
    left: 18%;
    background: rgba(158, 201, 255, 0.45);
    animation-delay: -8s;
  }

  .grid-sparkle {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 2;
    background-image: radial-gradient(circle at 1px 1px, rgba(47, 42, 68, 0.15) 1px, transparent 0);
    background-size: 24px 24px;
    mask-image: radial-gradient(ellipse 85% 70% at 50% 35%, #000 40%, transparent 100%);
  }

  .hero {
    border-radius: var(--panel-radius);
    border: 2px solid var(--line);
    background: rgba(255, 255, 255, 0.8);
    box-shadow: 0 18px 45px rgba(47, 42, 68, 0.1);
    padding: clamp(24px, 5vw, 54px);
    overflow: visible;
    position: relative;
    isolation: isolate;
  }

  .hero-bg {
    position: absolute;
    inset: 0;
    border-radius: inherit;
    overflow: hidden;
    pointer-events: none;
    z-index: 0;
  }

  .hero > *:not(.panel-hanger):not(.hero-bg) {
    position: relative;
    z-index: 2;
  }

  .panel-hanger {
    position: absolute;
    top: 26px;
    right: 10px;
    width: 164px;
    height: 152px;
    z-index: 12;
    --swing-angle: 0.17rad;
    --thread-length: 48px;
    --card-tilt: -0.06rad;
    --hanger-axis: 112px;
  }

  .panel-pin {
    position: absolute;
    top: 10px;
    left: calc(var(--hanger-axis) - 5px);
    width: 10px;
    height: 10px;
    border: 2px solid rgba(47, 42, 68, 0.28);
    border-radius: 50%;
    background: var(--secondary);
    box-shadow: 0 2px 0 rgba(47, 42, 68, 0.15);
  }

  .panel-arm {
    position: absolute;
    top: 16px;
    left: var(--hanger-axis);
    width: 0;
    transform-origin: top center;
    transform: rotate(var(--swing-angle));
    pointer-events: none;
  }

  .panel-thread {
    display: block;
    width: 2px;
    margin-left: -1px;
    height: var(--thread-length);
    background: rgba(47, 42, 68, 0.45);
  }

  .panel-tag {
    position: absolute;
    left: 0;
    top: var(--thread-length);
    transform: translateX(-50%) rotate(var(--card-tilt));
    transform-origin: top center;
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    width: 86px;
    border: 2px solid rgba(47, 42, 68, 0.26);
    border-radius: 12px 12px 16px 16px;
    background: linear-gradient(160deg, rgba(255, 255, 255, 0.97), rgba(255, 255, 255, 0.88));
    box-shadow: 0 8px 14px rgba(47, 42, 68, 0.16);
    padding: 8px 10px 10px;
    font-family: "IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: 12px;
    color: rgba(47, 42, 68, 0.86);
    text-align: center;
    z-index: 1;
    pointer-events: auto;
    cursor: grab;
    touch-action: none;
    user-select: none;
  }

  .panel-tag-label {
    display: block;
    font-size: 10px;
    letter-spacing: 0.1em;
    line-height: 1;
    opacity: 0.72;
    text-transform: uppercase;
  }

  .panel-tag-value {
    display: block;
    margin-top: 2px;
    font-size: 18px;
    font-weight: 700;
    letter-spacing: 0.08em;
    line-height: 1;
    color: var(--primary);
  }

  .hero-bg::after {
    content: "";
    position: absolute;
    width: 186px;
    height: 186px;
    right: 16px;
    bottom: 16px;
    border-radius: 42% 58% 60% 40%;
    background: linear-gradient(120deg, rgba(232, 135, 131, 0.38), rgba(255, 217, 125, 0.42));
    transform: rotate(-13deg);
    z-index: 0;
  }


  .badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 9px 14px;
    border-radius: 999px;
    border: 2px solid rgba(47, 42, 68, 0.22);
    background: rgba(255, 255, 255, 0.82);
    font-size: clamp(18px, 2.8vw, 23px);
    margin-bottom: 14px;
  }

  .badge-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--primary);
    animation: pulseDot 2s ease-in-out infinite;
  }

  .title {
    font-family: var(--font-heading);
    font-size: clamp(38px, 8vw, 72px);
    line-height: 1;
    letter-spacing: 0.01em;
    margin-bottom: 14px;
  }

  .mobile-br {
    display: none;
  }

  .title .swirl {
    color: var(--primary);
    text-shadow: 3px 4px 0 rgba(255, 255, 255, 0.85);
  }

  .subtitle {
    max-width: 680px;
    font-size: clamp(18px, 2.8vw, 26px);
    line-height: 1.2;
    color: var(--muted);
    margin-bottom: 24px;
  }

  .command-card {
    border: 2px solid rgba(47, 42, 68, 0.2);
    border-radius: 20px;
    background: var(--paper);
    overflow: hidden;
    max-width: 700px;
  }

  .command-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    background: rgba(158, 201, 255, 0.22);
    border-bottom: 2px solid rgba(47, 42, 68, 0.14);
    padding: 10px 14px;
  }

  .dots {
    display: inline-flex;
    gap: 6px;
  }

  .dots span {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(47, 42, 68, 0.28);
  }

  .command-title {
    font-family: var(--font-heading);
    font-size: 19px;
    font-weight: 600;
  }

  .command-body {
    font-family: "IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: clamp(14px, 2.1vw, 18px);
    padding: 16px;
    display: flex;
    flex-wrap: nowrap;
    gap: 10px;
    align-items: center;
    overflow-x: auto;
  }

  .prompt {
    color: var(--primary);
  }

  .cmd {
    color: #3c3559;
    min-height: 1.2em;
    white-space: nowrap;
  }

  .cursor {
    width: 8px;
    height: 18px;
    background: var(--ink);
    animation: blink 1s steps(1, end) infinite;
  }

  .command-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 0 16px 16px;
  }

  .btn {
    border: 2px solid rgba(47, 42, 68, 0.26);
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.86);
    color: var(--ink);
    padding: 9px 16px;
    font-family: "Nunito", sans-serif;
    font-size: 16px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
  }

  .btn:hover {
    transform: translateY(-1px);
  }

  .btn.primary {
    background: rgba(232, 135, 131, 0.28);
  }

  #copy {
    position: relative;
    text-align: center;
  }

  #copy .copy-label-sizer {
    visibility: hidden;
    white-space: nowrap;
  }

  #copy [data-copy-label] {
    position: absolute;
    inset: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    pointer-events: none;
  }

  .hero-block {
    margin-top: 26px;
    padding-top: 0;
    border-top: 0;
  }

  .hero-block-head {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 14px;
  }

  .hero-block-label {
    font-family: var(--font-heading);
    font-size: 18px;
    font-weight: 600;
    letter-spacing: 0.01em;
    color: rgba(47, 42, 68, 0.9);
  }

  .hero-block-rule {
    flex: 1;
    height: 2px;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(232, 135, 131, 0.42), rgba(155, 196, 182, 0.26), rgba(47, 42, 68, 0.05));
  }

  .feature-grid {
    margin-top: 0;
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
  }

  .feature-item {
    border: 2px solid rgba(47, 42, 68, 0.16);
    border-radius: 18px;
    background: rgba(255, 255, 255, 0.86);
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    min-height: 138px;
  }

  .feature-item:nth-child(odd) {
    background: rgba(255, 255, 255, 0.88);
  }

  .feature-item:nth-child(even) {
    background: rgba(155, 196, 182, 0.12);
  }

  .feature-kicker {
    display: inline-flex;
    width: fit-content;
    border: 1px solid rgba(47, 42, 68, 0.2);
    border-radius: 999px;
    padding: 3px 8px;
    font-family: "Nunito", sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: rgba(47, 42, 68, 0.72);
    background: rgba(255, 255, 255, 0.7);
  }

  .feature-title {
    font-family: var(--font-heading);
    font-size: 19px;
    font-weight: 600;
    line-height: 1.2;
    color: rgba(47, 42, 68, 0.92);
  }

  .feature-desc {
    font-size: 15px;
    line-height: 1.35;
    color: rgba(47, 42, 68, 0.76);
  }

  .feature-more {
    margin-top: 10px;
    text-align: center;
    font-family: "Nunito", sans-serif;
    font-size: 14px;
    letter-spacing: 0.08em;
    text-transform: lowercase;
    color: rgba(47, 42, 68, 0.58);
  }

  .feature-more-prefix {
    text-decoration: none;
  }

  .feature-more-link {
    text-decoration-line: underline;
    text-decoration-color: rgba(47, 42, 68, 0.52);
    text-decoration-thickness: 0.08em;
    text-underline-offset: 0.22em;
    color: inherit;
  }

  .links-grid {
    margin-top: 0;
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
  }

  .link-card {
    border-radius: 18px;
    border: 2px solid rgba(47, 42, 68, 0.16);
    background: rgba(255, 255, 255, 0.82);
    padding: 14px;
    text-decoration: none;
    color: var(--ink);
  }

  .link-card strong {
    display: block;
    font-family: var(--font-heading);
    font-size: 22px;
    font-weight: 600;
    line-height: 1;
  }

  .link-card span {
    display: block;
    font-size: 16px;
    color: rgba(47, 42, 68, 0.76);
    line-height: 1.25;
    margin-top: 6px;
  }

  .link-card:nth-child(1) { transform: rotate(-1.3deg); }
  .link-card:nth-child(2) { transform: rotate(0.6deg); }
  .link-card:nth-child(3) { transform: rotate(-0.7deg); }
  .link-card:hover { transform: translateY(-2px) rotate(-0.2deg); }

  @keyframes drift {
    0%,
    100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-10px) scale(1.04); }
  }


  @keyframes pulseDot {
    0%,
    100% { transform: scale(1); }
    50% { transform: scale(0.72); }
  }

  @keyframes blink {
    0%,
    50% { opacity: 1; }
    51%,
    100% { opacity: 0; }
  }

  @media (max-width: 900px) {
    .feature-grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .links-grid {
      grid-template-columns: 1fr;
    }

    .hero-bg::after {
      width: 160px;
      height: 160px;
      right: 12px;
      bottom: 12px;
    }

    .panel-hanger {
      right: 8px;
      top: 20px;
      transform: scale(0.9);
      transform-origin: top right;
    }
  }

  @media (max-width: 640px) {
    .mobile-br {
      display: block;
    }

    .command-actions {
      flex-direction: column;
      align-items: flex-start;
    }

    .feature-grid {
      grid-template-columns: 1fr;
    }

    .feature-item {
      min-height: 0;
    }

    .hero-block {
      margin-top: 22px;
      padding-top: 0;
    }

    .hero-block-label {
      font-size: 16px;
    }

    .panel-hanger {
      right: 6px;
      top: 18px;
      transform: scale(0.8);
      transform-origin: top right;
    }
  }
</style>

<script type="module">
  const installCmd = "curl -fsSL https://tako.sh/install | sh";
  const typedCmd = document.getElementById("typed-cmd");
  const copyBtn = document.getElementById("copy");
  const copyBtnLabel = copyBtn?.querySelector("[data-copy-label]");
  const hanger = document.getElementById("mit-hanger");
  const pin = document.getElementById("mit-pin");
  const tag = document.getElementById("mit-tag");

  let i = 0;
  const writeChar = () => {
    if (!typedCmd || i >= installCmd.length) {
      return;
    }
    typedCmd.textContent += installCmd.charAt(i);
    i += 1;
    setTimeout(writeChar, 35 + Math.random() * 28);
  };
  setTimeout(writeChar, 620);

  const setCopyButtonText = (text) => {
    if (copyBtnLabel instanceof HTMLElement) {
      copyBtnLabel.textContent = text;
      return;
    }
    if (copyBtn instanceof HTMLElement) {
      copyBtn.textContent = text;
    }
  };

  copyBtn?.addEventListener("click", async () => {
    try {
      await navigator.clipboard.writeText(installCmd);
      setCopyButtonText("copied");
      setTimeout(() => {
        setCopyButtonText("copy install command");
      }, 1400);
    } catch {
      setCopyButtonText("copy failed");
      setTimeout(() => {
        setCopyButtonText("copy install command");
      }, 1400);
    }
  });

  if (hanger instanceof HTMLElement && pin instanceof HTMLElement && tag instanceof HTMLElement) {
    const restAngle = 0;
    const restLength = 62;
    const minLength = 30;
    const maxLength = 220;
    let angle = -0.42;
    let angularVelocity = 1.1;
    let length = restLength * 0.5;
    let lengthVelocity = 210;
    let dragging = false;
    const gravity = 1200;
    const angularDamping = 2.8;
    const angleSpring = 2.2;
    const lengthSpring = 19;
    const posePrecision = {
      angle: 0.001,
      length: 1,
      tilt: 0.001,
    };
    const settleThreshold = {
      angle: 0.002,
      angularVelocity: 0.02,
      length: 0.2,
      lengthVelocity: 2,
    };
    const lastPose = {
      angle: Number.NaN,
      length: Number.NaN,
      tilt: Number.NaN,
    };

    let lastFrame = performance.now();
    let dragSampleTime = lastFrame;
    let dragAngleSample = angle;
    let dragLengthSample = length;

    const clamp = (value, min, max) => Math.min(max, Math.max(min, value));
    const quantize = (value, step) => Math.round(value / step) * step;
    const formatRad = (value) => value.toFixed(3);
    const isNearRest = () => {
      return (
        Math.abs(angle - restAngle) < settleThreshold.angle &&
        Math.abs(angularVelocity) < settleThreshold.angularVelocity &&
        Math.abs(length - restLength) < settleThreshold.length &&
        Math.abs(lengthVelocity) < settleThreshold.lengthVelocity
      );
    };

    const applyPose = () => {
      const nextAngle = quantize(angle, posePrecision.angle);
      const nextLength = quantize(length, posePrecision.length);
      const nextTilt = quantize(-angle * 0.36, posePrecision.tilt);

      if (nextAngle !== lastPose.angle) {
        hanger.style.setProperty("--swing-angle", `${formatRad(nextAngle)}rad`);
        lastPose.angle = nextAngle;
      }
      if (nextLength !== lastPose.length) {
        hanger.style.setProperty("--thread-length", `${nextLength}px`);
        lastPose.length = nextLength;
      }
      if (nextTilt !== lastPose.tilt) {
        hanger.style.setProperty("--card-tilt", `${formatRad(nextTilt)}rad`);
        lastPose.tilt = nextTilt;
      }
    };

    const setFromPointer = (x, y) => {
      const rect = pin.getBoundingClientRect();
      const anchorX = rect.left + rect.width / 2;
      const anchorY = rect.top + rect.height / 2;
      const dx = x - anchorX;
      const dy = y - anchorY;
      angle = -Math.atan2(dx, dy);
      length = clamp(Math.hypot(dx, dy), minLength, maxLength);
    };

    const endDrag = (pointerId) => {
      if (!dragging) {
        return;
      }
      dragging = false;
      if (typeof pointerId === "number" && tag.hasPointerCapture(pointerId)) {
        tag.releasePointerCapture(pointerId);
      }
      angularVelocity = clamp(angularVelocity, -7.5, 7.5);
      lengthVelocity = clamp(lengthVelocity, -220, 220);
      tag.style.cursor = "grab";
      document.body.style.userSelect = "";
    };

    tag.addEventListener("pointerdown", (event) => {
      dragging = true;
      tag.setPointerCapture(event.pointerId);
      angularVelocity = 0;
      lengthVelocity = 0;
      setFromPointer(event.clientX, event.clientY);
      dragSampleTime = performance.now();
      dragAngleSample = angle;
      dragLengthSample = length;
      applyPose();
      tag.style.cursor = "grabbing";
      document.body.style.userSelect = "none";
    });

    tag.addEventListener("pointermove", (event) => {
      if (!dragging) {
        return;
      }
      setFromPointer(event.clientX, event.clientY);
      const now = performance.now();
      const dt = Math.max((now - dragSampleTime) / 1000, 1 / 240);
      angularVelocity = (angle - dragAngleSample) / dt;
      lengthVelocity = (length - dragLengthSample) / dt;
      dragSampleTime = now;
      dragAngleSample = angle;
      dragLengthSample = length;
      applyPose();
    });

    tag.addEventListener("pointerup", (event) => {
      endDrag(event.pointerId);
    });

    tag.addEventListener("pointercancel", (event) => {
      endDrag(event.pointerId);
    });

    tag.addEventListener("lostpointercapture", () => {
      dragging = false;
      tag.style.cursor = "grab";
      document.body.style.userSelect = "";
    });

    const tick = (now) => {
      const dt = Math.min((now - lastFrame) / 1000, 0.033);
      lastFrame = now;

      if (!dragging) {
        // Let the hanger fully settle by removing breeze in the near-rest band.
        const breeze = isNearRest() ? 0 : Math.sin(now * 0.0017) * 0.18 + Math.sin(now * 0.00061) * 0.08;
        const gravityForce = -(gravity / Math.max(length, 1)) * Math.sin(angle);
        const springForce = (restAngle - angle) * angleSpring;
        angularVelocity += (gravityForce + springForce + breeze - angularVelocity * angularDamping) * dt;
        angle += angularVelocity * dt;

        lengthVelocity += (restLength - length) * lengthSpring * dt;
        lengthVelocity *= Math.exp(-5.0 * dt);
        length += lengthVelocity * dt;
        length = clamp(length, minLength, maxLength);

        if (isNearRest()) {
          angle = restAngle;
          angularVelocity = 0;
          length = restLength;
          lengthVelocity = 0;
        }
      }

      applyPose();
      requestAnimationFrame(tick);
    };

    applyPose();
    requestAnimationFrame(tick);
  }
</script>
